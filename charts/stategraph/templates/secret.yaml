{{- if not .Values.postgresql.auth.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "stategraph.fullname" . }}
  labels:
    {{- include "stategraph.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if .Values.postgresql.auth.password }}
  db-password: {{ .Values.postgresql.auth.password | quote }}
  {{- else }}
  db-password: {{ randAlphaNum 32 | quote }}
  {{- end }}
  {{- if .Values.stategraph.oauth.enabled }}
  oauth-client-id: {{ .Values.stategraph.oauth.clientId | quote }}
  oauth-client-secret: {{ .Values.stategraph.oauth.clientSecret | quote }}
  {{- if and (eq .Values.stategraph.oauth.type "google") .Values.stategraph.oauth.google.serviceAccountJson }}
  oauth-service-account-json: {{ .Values.stategraph.oauth.google.serviceAccountJson | quote }}
  {{- end }}
  {{- end }}
{{- end }}
